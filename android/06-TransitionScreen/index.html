<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>検索結果一覧画面の作成 | Android programing getstart</title><link rel="stylesheet" type="text/css" href="/AndroidCourse//css/normalize.css"><link rel="stylesheet" type="text/css" href="/AndroidCourse//css/highlight.css"><link rel="stylesheet" type="text/css" href="/AndroidCourse//css/very-simple.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="../../favicon.ico"></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="../../." class="title">Android programing getstart</a><span class="subtitle"></span><label id="toggle-menu" for="menu" onclick><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><nav id="nav"><div class="container"><a href="../../index.html" class="sidebar-nav-item">Home</a></div></nav><div id="header-margin-bar"></div><!-- gallery that comes before the header--><div class="wrapper"><div class="container post-header"><h1>検索結果一覧画面の作成</h1></div></div>
<article><div class="container post"><p>検索結果一覧を表示する検索結果画面の作成とリスト表示レイアウトの実装方法を学習します。<br>また検索画面から検索結果画面を表示するための画面遷移処理の実装方法を学習します。</p>
<!-- toc -->
<ul>
<li><a href="#学習ポイント">学習ポイント</a></li>
<li><a href="#新しい画面を作成する">新しい画面を作成する</a><ul>
<li><a href="#androidmanifestファイルの確認">AndroidManifestファイルの確認</a></li>
</ul>
</li>
<li><a href="#画面遷移処理機能">画面遷移処理機能</a><ul>
<li><a href="#intent">Intent</a></li>
</ul>
</li>
<li><a href="#検索結果画面レイアウト作成">検索結果画面レイアウト作成</a></li>
<li><a href="#一覧表示機能">一覧表示機能</a><ul>
<li><a href="#コレクション-配列">コレクション、配列</a></li>
</ul>
</li>
<li><a href="#カスタム一覧表示機能">カスタム一覧表示機能</a><ul>
<li><a href="#listviewの行レイアウト作成">ListViewの行レイアウト作成</a></li>
<li><a href="#継承">継承</a></li>
<li><a href="#カスタムadapterクラスの作成">カスタムAdapterクラスの作成</a></li>
<li><a href="#カスタム一覧機能の実装">カスタム一覧機能の実装</a><ul>
<li><a href="#コンストラクタ">コンストラクタ</a></li>
</ul>
</li>
<li><a href="#スコープ">スコープ</a></li>
<li><a href="#アクセス修飾子">アクセス修飾子</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<p><a href="/AndroidCourse/android/05-ButtonAction">ボタンイベントの実装</a>からの引き続きの学習ページです。</p>
<h1><span id="学習ポイント">学習ポイント</span></h1><ul>
<li>ListViewを利用したリストレイアウトの実装方法</li>
<li>新規画面の作り方</li>
<li>画面遷移処理の実装方法</li>
<li>xmlファイルでのレイアウト作成のおさらい</li>
<li>コレクション / 配列</li>
<li>継承</li>
<li>コンストラクタ</li>
<li>アクセス修飾子</li>
</ul>
<p>蔵書検索を行なった結果複数の蔵書情報を取得できる場合があります、複数取得した蔵書情報を一覧表示します。<br>その前段として、一覧表示を行うためのウィジェットListViewの使い方を学習します。<br>また、検索画面で入力された文字の検索を行うために画面遷移処理及び、画面遷移時に次の画面へ情報を渡す処理の実装方法を学習します。</p>
<h1><span id="新しい画面を作成する">新しい画面を作成する</span></h1><p>Androidアプリに置いて<strong>画面 = Activity</strong>であることは<a href="/AndroidCourse/android/02-AndroicConcept">Androidの概念</a>で解説しました。<br>今回は蔵書検索アプリのプロジェクトに新しいActivityを追加していきます。</p>
<p>新しいActivityの追加はメニューかもしくは左のプロジェクトツリーが表示されているウィンドウで右クリック(macでは２本指でクリック)から新しいActivityの追加を行えます。</p>
<p>新しく作成するActivityは<strong>Empty Activity</strong>を選びます。</p>
<ol>
<li>メニュー &gt; File &gt; New &gt; Activity &gt; Empty Activity<img src="/AndroidCourse/android/06-TransitionScreen/createactivity01_1.png" width="500" title="CreateNewActivity"></li>
<li>ウィンドウ右クリック &gt; New &gt; Activity &gt; Empty Activity<img src="/AndroidCourse/android/06-TransitionScreen/createactivity01_2.png" width="500" title="CreateNewActivity">
</li>
</ol>
<p>新しく作成するActivityのファイル名と同時に作成するxmlファイルの名称の入力を求められます。<br>以下の名称で新しいActivityを作成します。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td>Activity Name</td>
<td>ResultListActivity</td>
</tr>
<tr>
<td>Generate Layout File</td>
<td>チェックを<font color="blue">つける</font></td>
</tr>
<tr>
<td>Layout Name</td>
<td>activity_result_list</td>
</tr>
<tr>
<td>Luncher Activity</td>
<td>チェックを<font color="red">つけない</font></td>
</tr>
<tr>
<td>Backwords Compatibility(AppCompat)</td>
<td>チェックを<font color="blue">つける</font></td>
</tr>
</tbody>
</table>
<img src="/AndroidCourse/android/06-TransitionScreen/createactivity02.png" width="500" title="CreateNewActivity">
<p>項目の入力が終わったら<code>Finish</code>ボタンをクリックします。</p>
<p>新しいActivityの作成が終わるとウィンドウは閉じAndroid Studioのエディタに戻ります。<br>プロジェクトツリーには<font color="green">ResultListActivity.java</font>と<font color="green">activity_result_list.xml</font>のファイルが追加されます。<br><img src="/AndroidCourse/android/06-TransitionScreen/createactivity03.png" width="350" title="CreateNewActivity"></p>
<h2><span id="androidmanifestファイルの確認">AndroidManifestファイルの確認</span></h2><p>Activityがプロジェクトに追加された場合でも、アプリで表示するためにはアプリの設計書となる<code>AndroidManifest.xml</code>に利用することを記述する必要があります。<br><code>AndroidManifest.xml</code>の場所は以下にあります。</p>
<blockquote>
<p>app -&gt; manifests -&gt; AndroidManifest.xml</p>
</blockquote>
<img src="/AndroidCourse/android/06-TransitionScreen/createactivity04.png" width="400" title="CreateNewActivity">
<p>作成した<strong>ResultListActivity</strong>が記載されているか確認すると<br><img src="/AndroidCourse/android/06-TransitionScreen/createactivity05.png" width="550" title="CreateNewActivity"><br>無事に記述されていることが確認できました、他の行を確認すると検索画面として表示している<strong>MainActivity</strong>も記載されています。</p>
<p><code>AndroidManifest.xml</code>はアプリ名やアプリアイコン、アプリ起動時に表示するActivityなどの設定が記述されたアプリの概要設計書のようなファイルです、他にはPush通知機能を追加する時にもファイルの修正が必要になるので覚えておきましょう。</p>
<h1><span id="画面遷移処理機能">画面遷移処理機能</span></h1><p>新しいActivityが作成できたので、MainActivityの<em>蔵書検索ボタン</em>をクリックした時、ResultListActivityに表示が切り替わる様にMainActivity.javaを修正していきます。<br><figure class="highlight java"><figcaption><span>MainActivity.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">...一部省略</span><br><span class="line">    View.OnClickListener bookSearchEvent = <span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// コンソールログにボタンが押されたことを出力(表示)</span></span><br><span class="line">            Log.d(<span class="string">"BookSearchBtn"</span>, <span class="string">"onClick: BookSearch Button"</span>);</span><br><span class="line">            <span class="comment">// 入力された文字をToast(トースト)に表示</span></span><br><span class="line">            Toast.makeText(getBaseContext()</span><br><span class="line">                    , <span class="string">"入力された文字は ["</span> + bookSearchEditor.getText().toString() + <span class="string">"]です。"</span></span><br><span class="line">                    , Toast.LENGTH_LONG).show();</span><br><span class="line">            <span class="comment">//↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓追加↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line">            <span class="comment">// 画面遷移するためのIntentをインスタンス化</span></span><br><span class="line">            Intent intent = <span class="keyword">new</span> Intent(MainActivity.<span class="keyword">this</span>, ResultListActivity.class);</span><br><span class="line">            <span class="comment">// 画面遷移アクションを実行</span></span><br><span class="line">            startActivity(intent);</span><br><span class="line">            <span class="comment">//↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑追加↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure></p>
<p>コードの修正が終わったらエミュレータで動作確認してください。<br>以下のように画面遷移できましたか？<br><img src="/AndroidCourse/android/06-TransitionScreen/TransitionScreen.gif" width="300" title="TransitionScreen"><br>またエミュレータ左下の三角ボタンをクリックすると前の画面に戻ります。<br><img src="/AndroidCourse/android/06-TransitionScreen/BackScreen.png" width="400" title="BackScreen"></p>
<h2><span id="intent">Intent</span></h2><p>Android開発における４大要素の一つとして紹介されている<code>Intent</code>が出てきました。<br>Intentは別Activityの呼び出し（画面遷移）や別のアプリを起動する時などに利用する要素になります、画面遷移時の利用方法としては</p>
<ol>
<li>Intentクラスを宣言、インスタンス化</li>
<li>startActivityメソッドの引数に”1.”で宣言したIntentをセット</li>
</ol>
<p>この２つの手順でActivity間の画面遷移が実装できてしまいます。<br>今回画面遷移時に生成したIntentですが、<br>一つ目の引数にはContextと呼ばれるクラスをセット<font color="red">(Contextは少々ややこしいクラスなので今後のページで詳しく解説します）</font>Contextは現在開いているActivityが該当するので自身を表す”this”と言う属性を記述してセットする。<br>２つ目の引数に遷移したいActivityのクラス情報をセットする。</p>
<p>最初のうちは画面遷移を行う場合、上記のルールで画面遷移のコードを実装するよう癖をつけておきましょう。</p>
<h1><span id="検索結果画面レイアウト作成">検索結果画面レイアウト作成</span></h1><p>検索画面同様にLayoutEditorとConstraintsLayoutを使って検索結果画面のレイアウト構成を作成していきます。<br><img src="/AndroidCourse/android/06-TransitionScreen/re_le00.png" width="200" title="CreateResultListLayout"></p>
<p>ResultListActivityの新規作成時、同時に作成された<code>activity_result_list.xml</code>を修正します。</p>
<blockquote>
<p>app -&gt; res -&gt; layout -&gt; activity_result_list.xml</p>
</blockquote>
<p>検索結果画面は検索した結果を取得し、その一覧を表示します、一覧表示を行うためのコンポーネントとして<code>ListView</code>を利用します。<br>デザインビューに<code>ListView</code>を乗せるには検索画面の時の”Button”や”EditText”と同じように”コンポーネントをクリックしたままデザインビューまでマウスカーソルをマウスカーソルを移動させ、離す”と言う手順です。<br><strong>Palette</strong>から<code>ListView</code>を探しデザインビューにビューに乗せます。<br><img src="/AndroidCourse/android/06-TransitionScreen/re_le01.png" width="500" title="CreateResultListLayout"><br>画面の上下左右と制約を設定します。<br><img src="/AndroidCourse/android/06-TransitionScreen/re_le02.png" width="500" title="CreateResultListLayout"><br><code>ListView</code>に表示するデータの設定はjavaファイルで実装しますのでjavaファイルと関連付けをするために<strong>Attributes</strong>から<em>ID</em>項目を設定します。<br><img src="/AndroidCourse/android/06-TransitionScreen/re_le03.png" width="400" title="CreateResultListLayout"></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td>ID</td>
<td>ResultList</td>
</tr>
</tbody>
</table>
<h1><span id="一覧表示機能">一覧表示機能</span></h1><p>検索結果画面の一覧表示機能を実装していきます、まずはListViewの使い方を理解するために理解するために10行のリスト表示を行い、各行に行数番号の文字を表示してみます。<br><figure class="highlight java"><figcaption><span>ResultListActivity.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResultListActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓追加↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line">    <span class="comment">// xmlファイルのコンポーネントと関連付ける要素</span></span><br><span class="line">    ListView resultListView;</span><br><span class="line">    <span class="comment">// 検証用コレクションデータ</span></span><br><span class="line">    List&lt;String&gt; listData = Arrays.asList(<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="string">"4"</span>, <span class="string">"5"</span>, <span class="string">"6"</span>, <span class="string">"7"</span>, <span class="string">"8"</span>, <span class="string">"9"</span>, <span class="string">"10"</span>);</span><br><span class="line">    <span class="comment">// ListViewの表示内容を管理するクラス</span></span><br><span class="line">    ArrayAdapter&lt;String&gt; adapter</span><br><span class="line">    <span class="comment">//↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑追加↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_result_list);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓追加↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line">        <span class="comment">// xmlファイルのコンポーネントと関連付け</span></span><br><span class="line">        resultListView = findViewById(R.id.ResultListView);</span><br><span class="line">        <span class="comment">// ListViewに表示する情報をまとめるAdapterをインスタンス化</span></span><br><span class="line">        adapter = <span class="keyword">new</span> ArrayAdapter&lt;&gt;(ResultListActivity.<span class="keyword">this</span></span><br><span class="line">                , android.R.layout.simple_list_item_1</span><br><span class="line">                , listData);</span><br><span class="line">        <span class="comment">// ListViewに表示情報をまとめたAdapterをセット</span></span><br><span class="line">        resultListView.setAdapter(adapter);</span><br><span class="line">        <span class="comment">//↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑追加↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>合わせてListViewの行をクリックされた時のイベントをセットしていきます。<br>行毎のクリックイベントはMainActivity.javaのボタンクリックとは別の実装方法を試していきます、クラス名の後ろに<code>implements AdapterView.OnItemClickListener</code>と入力<br><figure class="highlight java"><figcaption><span>ResultListActivity.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓修正↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResultListActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">AdapterView</span>.<span class="title">OnItemClickListener</span> </span>&#123;</span><br><span class="line"><span class="comment">//↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑修正↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑</span></span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>するとエラーの様な<font color="red">赤い下線</font>が表示されます。<br>クラス名 “ResultListActivity”をクリックし少し経過すると、赤い電球のようなアイコンが表示されるのでクリックします。<br><img src="/AndroidCourse/android/06-TransitionScreen/additemclick01.png" width="500" title="add Item ClickEvent"><br><code>implement methods</code>をクリックします。<br><img src="/AndroidCourse/android/06-TransitionScreen/additemclick02.png" width="500" title="add Item ClickEvent"><br><code>onItemClick...</code>が選択されている(青くなっている)状態で<code>OK</code>をクリックします。<br><img src="/AndroidCourse/android/06-TransitionScreen/additemclick03.png" width="300" title="add Item ClickEvent"><br><code>onItemClick()</code>メソッドが自動的に追加されます。<br><img src="/AndroidCourse/android/06-TransitionScreen/additemclick04.png" width="500" title="add Item ClickEvent"><br>あとは行をクリックした時の命令を実装します。<br><figure class="highlight java"><figcaption><span>ResultListActivity.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.activity_result_list);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// xmlファイルのコンポーネントと関連付け</span></span><br><span class="line">    resultListView = findViewById(R.id.ResultListView);</span><br><span class="line">    <span class="comment">// ListViewに表示する情報をまとめるAdapterをインスタンス化</span></span><br><span class="line">    adapter = <span class="keyword">new</span> ArrayAdapter&lt;&gt;(ResultListActivity.<span class="keyword">this</span></span><br><span class="line">            , android.R.layout.simple_list_item_1</span><br><span class="line">            , listData);</span><br><span class="line">    <span class="comment">// ListViewに表示情報をまとめたAdapterをセット</span></span><br><span class="line">    resultListView.setAdapter(adapter);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓追加↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line">    <span class="comment">// ListViewに行をクリックした時のイベントを登録</span></span><br><span class="line">    resultListView.setOnItemClickListener(ResultListActivity.<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑追加↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ListViewの各行をクリックした時の命令を実装</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemClick</span><span class="params">(AdapterView&lt;?&gt; adapterView, View view, <span class="keyword">int</span> i, <span class="keyword">long</span> l)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓追加↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line">    <span class="comment">// クリックした行番号をToastで表示する</span></span><br><span class="line">    Toast.makeText(ResultListActivity.<span class="keyword">this</span></span><br><span class="line">            , i + <span class="string">"行目をクリックしました"</span></span><br><span class="line">            , Toast.LENGTH_SHORT).show();</span><br><span class="line">    <span class="comment">//↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑追加↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>コードの実装が終わったらエミュレータで動作確認してみましょう。</p>
<p>今回のリストでは各行にテキストを１つ表示するリストとして実装しました。<br>Android SDKに用意されているリストと行のレイアウトを使用して表示させています。<br>更に各行をクリックすると”＊行目をクリックしました”とToastが表示されます。</p>
<p>多くの現場ではこのような使い方はすくなく<strong>Adapter</strong>クラスと行のレイアウトをカスタマイズして利用することがほとんどです。<br>次の工程では<strong>Adapter</strong>クラスのカスタマイズと行に表示するレイアウトをカスタマイズしていきます。</p>
<h2><span id="コレクション-配列">コレクション、配列</span></h2><p>Androidアプリの開発に用いられるjava言語では複数のデータを一つのまとまりとして利用することができます。<br>データの持ち方としては２つ方法がありそれぞれ<strong>コレクション</strong>、<strong>配列</strong>という概念があります、<br>どちらの形式においても一つのまとまりのデータは同じ形である必要があり、<font color="blue"><strong>型の違うデータを複数記憶することはできません</strong></font></p>
<p>主な違いとして</p>
<ul>
<li>配列は宣言時に要素の上限を決める必要がある。</li>
<li>コレクションは上限設定はなく動的に要素の数を増減できる。</li>
</ul>
<p>その他の差異の確認のため、例として３つの手順をそれぞれの概念を使って実装してみます。</p>
<ul>
<li>整数型のコレクション/配列を空で宣言</li>
<li>2つのデータを追加/代入</li>
<li>1つ目のデータを参照してログを表示</li>
</ul>
<figure class="highlight java"><figcaption><span>コレクション</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 空のコレクションを宣言</span></span><br><span class="line">List&lt;Integer&gt; integerList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"><span class="comment">// コレクションの1番目に10を追加</span></span><br><span class="line">integerList.add(<span class="number">10</span>);</span><br><span class="line"><span class="comment">// コレクションの2番目に20を追加</span></span><br><span class="line">integerList.add(<span class="number">20</span>);</span><br><span class="line"><span class="comment">// コレクションの1番目のデータを表示</span></span><br><span class="line">Log.d(<span class="string">"collection_arrarys"</span>, <span class="string">"Collection data check: "</span> + integerList.get(<span class="number">0</span>));</span><br><span class="line"><span class="comment">/* "Collection data check: 10" と表示されます */</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><figcaption><span>配列</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 空の配列を宣言</span></span><br><span class="line"><span class="keyword">int</span> integerArray[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</span><br><span class="line"><span class="comment">// 配列の1番目に10を代入</span></span><br><span class="line">integerArray[<span class="number">0</span>] = <span class="number">10</span>;</span><br><span class="line"><span class="comment">// 配列の2番目に20を代入</span></span><br><span class="line">integerArray[<span class="number">1</span>] = <span class="number">20</span>;</span><br><span class="line"><span class="comment">// 配列の1番目のデータを表示</span></span><br><span class="line">Log.d(<span class="string">"collection_arrarys"</span>, <span class="string">"Array data check: "</span> + integerArray[<span class="number">0</span>]);</span><br><span class="line"><span class="comment">/* "Array data check: 10" と表示されます */</span></span><br></pre></td></tr></table></figure>
<p>配列で値を代入する時や参照する時に変数名の後の”[]”は要素の場所を表すための<strong>順番(添字)</strong>を指定する箇所です、プログラムの配列で気をつけるポイントとして、1番目のデータを参照するためには ‘0’ と記述する必要があることです。<br>よって２番目のデータを参照するためには”[]”の添え字に ‘1’ と記述する必要があります。<br>３番目以降も同様に一つ小さい値を記述する必要があります。</p>
<p>データの数は動的な場合が多くほどんどの状況下でコレクションを使用して一覧表示などを作っています。</p>
<h1><span id="カスタム一覧表示機能">カスタム一覧表示機能</span></h1><p>一覧表示のサンプルプログラムができたところで、最終的にはインターネット上の蔵書情報を取得し画面に表示します。<br>その前にリストの表示内容をカスタマイズ方法を覚えていきましょう。<br>ListViewの表示をカスタマイズするためには行のレイアウトファイルを作成し、”Adapter”クラスを継承して新しいAdapterを作成していきます。<br>下図の様に各行が縦２行のデータになり、１行目は大きい文字、２行目は小さめの文字で表示する様なリストを作ります。<br><img src="/AndroidCourse/android/06-TransitionScreen/custom_list00.png" width="200" title="example custom list"><br><strong>継承</strong>に関しては実装時に解説します。</p>
<h2><span id="listviewの行レイアウト作成">ListViewの行レイアウト作成</span></h2><p>表示をカスタムしたListViewを作るには行毎のレイアウトを作成する必要があります。<br>先ほど１〜１０の数字が表示されていたところ縦に２つ並ぶテキストに作り変えて表示していきます。</p>
<p>新規レイアウトファイルを作成するため、以下の通り”Layout XML File”をクリックします。</p>
<blockquote>
<p>プロジェクトウィンドウ右クリック &gt; New &gt; XML &gt; Layout XML File</p>
</blockquote>
<img src="/AndroidCourse/android/06-TransitionScreen/createrow01.png" width="400" title="Create List Row">
<p>レイアウトファイル名、一番上位の要素を設定して<code>Finish</code>ボタンをクリックします。<br><img src="/AndroidCourse/android/06-TransitionScreen/createrow02.png" width="500" title="Create List Row"></p>
<table>
<thead>
<tr>
<th style="text-align:center">項目</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Layout File Name</td>
<td>row_result_list</td>
</tr>
<tr>
<td style="text-align:center">Root Tag</td>
<td>android.support.constraint.ConstraintLayout</td>
</tr>
</tbody>
</table>
<p>レイアウト作成されたら、<code>row_result_list.xml</code>ファイルを開き、 “TextView”をデザインビューに配置します。<br><img src="/AndroidCourse/android/06-TransitionScreen/createrow03.png" width="500" title="Create List Row"><br>“TextView”の上、左右を画面の端と制約を設定します。<br><img src="/AndroidCourse/android/06-TransitionScreen/createrow04.png" width="500" title="Create List Row"><br>“TextView”の要素範囲を最大に広げるため、<em>layout_width</em>属性を<font color="red">match_constraint</font>に変更します。<br><img src="/AndroidCourse/android/06-TransitionScreen/createrow05.png" width="500" title="Create List Row"><br>“TextView”の表示文字サイズを大きくするため<em>textAppearance</em>属性を<font color="red">AppCompat.Headline</font>に変更します。<br><img src="/AndroidCourse/android/06-TransitionScreen/createrow06.png" width="500" title="Create List Row"><br><em>ID</em>属性を<font color="red">RowListTitle</font>に変更します。<br><img src="/AndroidCourse/android/06-TransitionScreen/createrow07.png" width="500" title="Create List Row"><br>タイトルではない文言を表示するため”TextView”をもう一つデザインビューに配置します。<br><img src="/AndroidCourse/android/06-TransitionScreen/createrow08.png" width="500" title="Create List Row"><br>２つ目の “TextView”は上辺を<font color="red">RowListTitle</font>の下辺に制約をつけ、左右・下を画面の端と制約を設定します。<br><img src="/AndroidCourse/android/06-TransitionScreen/createrow09.png" width="500" title="Create List Row"><br>２つ目の “TextView”の<em>ID</em>属性を<font color="red">RowListSummary</font>に変更したら行のデザインは完成です。<br><img src="/AndroidCourse/android/06-TransitionScreen/createrow10.png" width="500" title="Create List Row"></p>
<h2><span id="継承">継承</span></h2><p>これから作成するカスタムAdapterクラスを作成するためには”BaseAdapter”クラスを継承したクラスを作成します。<br>そのために、<strong>継承</strong>とは何かを解説します。</p>
<p>継承とは継承元となるクラスのメソッドや変数などの機能を受け継いだクラスを指します。<br>継承元になるクラスを<strong>親クラス(スーパークラス)</strong>と呼び、継承先となるクラスを<strong>子クラス</strong>と呼びます。</p>
<p>継承を行うメリットは同じプログラムを記述する回数が減るのでコード量が減ること、また元の処理を拡張することができることです。<br>継承クラスの作り方は以下のような記述を行うだけで継承が成立します。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> 子クラス名 <span class="keyword">extends</span> 親クラス名 </span>&#123; ... &#125;</span><br></pre></td></tr></table></figure></p>
<p>当記事の中でも実は継承クラスを作っており、<br><code>MainActivity.java</code>、<code>ResultListActivity.java</code>などはActivityクラスを継承したクラスになります。<br>２つのクラスを見てみると<br><figure class="highlight java"><figcaption><span>MainActivity.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123; ... &#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><figcaption><span>ResultListActivity.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResultListActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">AdapterView</span>.<span class="title">OnItemClickListener</span> </span>&#123; ... &#125;</span><br></pre></td></tr></table></figure>
<p>と２つのActivityは “AppCompatActivity”クラスを継承しています。</p>
<p>継承を行うとメソッドなどの機能を受け継ぐと説明しました。<br>たとえば<code>MainActivity.java</code>の “onCreate”メソッドの宣言をみると以下の様に記述されています。<br><figure class="highlight java"><figcaption><span>MainActivity.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">       setContentView(R.layout.activity_main);</span><br><span class="line">	...一部省略</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>メソッド名の上の行に<code>@Override</code>と記述されている、アノテーションと呼ばれる<font color="red">おまじない</font>によって、”AppCompatActivity”が持つ “onCreate”メソッドの命令を一旦無視(<strong>オーバーライド(override)</strong>)して <code>MainActivity</code>の “onCreate”メソッドの命令を実行すると実装しているのです。</p>
<font color="blue"><strong><em>親クラスのメソッドを子クラスで拡張する場合はこのアノテーションのおまじないを記述する必要があるので気をつけましょう。</em></strong></font>

<p>続いての行の命令<code>super.onCreate(savedInstanceState);</code>では改めて親クラスである “AppCompatActivity”の “onCreate”メソッドを実行しています。<br>更に次の行からが継承のメリットになります。<br>当たり前に感じるかもしれませんが、<code>MainActivity</code>ではボタンクリックイベントや画面遷移の実装を行なっています。<br>それに対して<code>ResultListActivity</code>ではListViewの一覧表示処理を実装しています。<br>同じonCreateメソッドに対して別の命令を実行することができています、 “AppCompatActivity”を継承することで画面表示を行う “onCreate”メソッドが呼び出され実際に使用している<code>MainActivity</code>や<code>ResultListActivity</code>の “onCreate”メソッドから実行され現在の様に画面にレイアウトが表示されています。</p>
<h2><span id="カスタムadapterクラスの作成">カスタムAdapterクラスの作成</span></h2><p>まずは新しいクラスを作成します、新規クラス作成時に親クラスを設定することができます。</p>
<p>新規Javaクラスファイルを作成するため、以下の通り”Java Class”をクリックします。</p>
<blockquote>
<p>プロジェクトウィンドウ右クリック &gt; New &gt; Java Class</p>
</blockquote>
<img src="/AndroidCourse/android/06-TransitionScreen/createadpt01.png" width="500" title="Create List Adapter">
<p>Javaクラス名、親クラスの設定して<code>OK</code>ボタンをクリックします。<br><img src="/AndroidCourse/android/06-TransitionScreen/createadpt02.png" width="500" title="Create List Adapter"></p>
<table>
<thead>
<tr>
<th style="text-align:center">項目</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Name</td>
<td>ResultListAdapter</td>
</tr>
<tr>
<td style="text-align:center">Kind</td>
<td>Class</td>
</tr>
<tr>
<td style="text-align:center">Superclass</td>
<td>android.widget.BaseAdapter</td>
</tr>
<tr>
<td style="text-align:center">Interface(s)</td>
<td>-</td>
</tr>
<tr>
<td style="text-align:center">Package</td>
<td>***.***.bookbookdiscovery</td>
</tr>
<tr>
<td style="text-align:center">Visibility</td>
<td>Public</td>
</tr>
<tr>
<td style="text-align:center">Modifiers</td>
<td>None</td>
</tr>
</tbody>
</table>
<p>新しい<code>ResultListApater</code>クラスが作成されエディタに表示されますが、BaseAdapterクラスを継承したクラスを作成した場合には必ず<em>オーバーライド</em>しないといけないメソッドがいくつかあるので、まずはそのメソッド群を<code>ResultListAdapter</code>に宣言していきます。</p>
<p>クラス名 “ResultListAdapter”をクリックし少し経過すると、赤い電球のようなアイコンが表示されるのでクリックします。<br><img src="/AndroidCourse/android/06-TransitionScreen/createadpt03.png" width="500" title="Create List Adapter"><br>小さいウィンドウが表示されるので <font color="blue">Implement methods</font>をクリックします。<br><img src="/AndroidCourse/android/06-TransitionScreen/createadpt04.png" width="500" title="Create List Adapter"><br>新しいダイアログが表示されるのでそのまま<code>OK</code>をクリックします。<br><img src="/AndroidCourse/android/06-TransitionScreen/createadpt05.png" width="300" title="Create List Adapter"><br>ダイアログで選択していたメソッドが<code>ResultListAdapter</code>に追加され、エラーも消えます。<br><img src="/AndroidCourse/android/06-TransitionScreen/createadpt06.png" width="500" title="Create List Adapter"></p>
<h2><span id="カスタム一覧機能の実装">カスタム一覧機能の実装</span></h2><p>ListViewの表示をカスタマイズするために作成した<code>ResultListAdapter.java</code>を実装し<code>ResultListActivity.java</code>で利用する実装にコードを修正します。</p>
<p>実装の前に<strong>コンストラクタ</strong>という機能を紹介します。</p>
<h3><span id="コンストラクタ">コンストラクタ</span></h3><p>コンストラクタはクラスをインスタンス化した時に実行される命令(メソッドと認識しても概ね大丈夫です)でクラスの内部的な初期化処理を行う機能です。<br>コンストラクタは引数の数や引数の型違いなどで複数実装することができます。<br>これから実装するプログラムでは以下のように<code>new</code>キーワードを使った実装が処理された時にコンストラクタが処理されます。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adapter = new ResultListAdapter(ResultListActivity.this, listData);</span><br></pre></td></tr></table></figure></p>
<p>今回<code>ResultListAdapter</code>は内部で持つデータだけでは機能を果たせず、少なくとも<code>ResultListActivity</code>から　“Context”データを引数として受け取ることで、<br>行毎のレイアウトを読み込むために”LayoutInflater”クラスをインスタンス化する必要があります。<br>そのため、オリジナルのコンストラクタを実装することになります。<br>他の場合でもクラス内の変数を初期化する場合などにコンストラクタを利用するとプログラムが見やすくなります。</p>
<hr>
<p>ではカスタムレイアウトでの検索結果一覧画面を実装します。<br><figure class="highlight java"><figcaption><span>ResultListAdapter.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResultListAdapter</span> <span class="keyword">extends</span> <span class="title">BaseAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓追加↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line">    <span class="comment">// ListViewの描画に必要な変数を宣言</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; summaryList;</span><br><span class="line">    <span class="keyword">private</span> LayoutInflater layoutInflater;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// コンストラクタ(インスタンス時に呼び出されるメソッドのようなもの)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ResultListAdapter</span><span class="params">(Context context, List&lt;String&gt; summaryList)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.summaryList = summaryList;</span><br><span class="line">        <span class="keyword">this</span>.layoutInflater = LayoutInflater.from(context);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑追加↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓修正↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line">        <span class="comment">// 一覧表示する要素数を返却する</span></span><br><span class="line">        <span class="keyword">return</span> summaryList.size();</span><br><span class="line">        <span class="comment">//↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑修正↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// indexやオブジェクト情報などを返却する</span></span><br><span class="line">        <span class="comment">// 一旦nullのまま</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getItemId</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 行で表示しているLayoutIdやindex、特別なIDを返却する</span></span><br><span class="line">        <span class="comment">// 一旦nullのまま</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">getView</span><span class="params">(<span class="keyword">int</span> i, View view, ViewGroup viewGroup)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓追加↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line">        <span class="comment">// 各行の表示レイアウト読み込みや、描画情報の設定を実装する</span></span><br><span class="line">        <span class="comment">// getViewで返却されたViewがListViewに表示される</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// viewの中身が空かチェック</span></span><br><span class="line">        <span class="keyword">if</span> (view == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// viewがレイアウトを読み込んでいない場合は"row_result_list"を読み込む</span></span><br><span class="line">            view = layoutInflater.inflate(R.layout.row_result_list, viewGroup, <span class="keyword">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// row_result_listのTitleとSummaryに文言を代入</span></span><br><span class="line">        TextView titleView = view.findViewById(R.id.RowListTitle);</span><br><span class="line">        TextView summaryView = view.findViewById(R.id.RowListSummary);</span><br><span class="line"></span><br><span class="line">        titleView.setText((i + <span class="number">1</span>) + <span class="string">"ページ目"</span>);</span><br><span class="line">        summaryView.setText(summaryList.get(i));</span><br><span class="line">        <span class="comment">//↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑追加↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓修正↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line">        <span class="comment">// 文字情報を代入されたviewを返却</span></span><br><span class="line">        <span class="keyword">return</span> view;</span><br><span class="line">        <span class="comment">//↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑修正↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><figcaption><span>ResultListActivity.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResultListActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">AdapterView</span>.<span class="title">OnItemClickListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓修正↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line">    <span class="comment">// xmlファイルのコンポーネントと関連付ける要素</span></span><br><span class="line">    <span class="keyword">private</span> ListView resultListView;</span><br><span class="line">    <span class="comment">// 検証用コレクションデータ</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; listData = Arrays.asList(<span class="string">"Android アプリ開発の環境構築"</span></span><br><span class="line">            , <span class="string">"Android OS とは"</span></span><br><span class="line">            , <span class="string">"Androidの概念"</span></span><br><span class="line">            , <span class="string">"Androidアプリ開発を始める"</span></span><br><span class="line">            , <span class="string">"検索画面レイアウト作成"</span></span><br><span class="line">            , <span class="string">"ボタンイベントの実装"</span></span><br><span class="line">            , <span class="string">"検索結果画面への遷移実装"</span></span><br><span class="line">            , <span class="string">"非同期処理、REST API通信の実装"</span></span><br><span class="line">            , <span class="string">"検索履歴機能"</span></span><br><span class="line">            , <span class="string">"Firebase導入"</span>);</span><br><span class="line">    <span class="comment">// ListViewの表示内容を管理するクラス</span></span><br><span class="line">    <span class="keyword">private</span> ResultListAdapter adapter;</span><br><span class="line">    <span class="comment">//↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑修正↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_result_list);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// xmlファイルのコンポーネントと関連付け</span></span><br><span class="line">        resultListView = findViewById(R.id.ResultListView);</span><br><span class="line">        <span class="comment">//↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓修正↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line">        <span class="comment">// ListViewに表示する情報をまとめるAdapterをインスタンス化</span></span><br><span class="line">        adapter = <span class="keyword">new</span> ResultListAdapter(ResultListActivity.<span class="keyword">this</span>, listData);</span><br><span class="line">        <span class="comment">//↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑修正↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑</span></span><br><span class="line">        <span class="comment">// ListViewに表示情報をまとめたAdapterをセット</span></span><br><span class="line">        resultListView.setAdapter(adapter);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ListViewに行をクリックした時のイベントを登録</span></span><br><span class="line">        resultListView.setOnItemClickListener(ResultListActivity.<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ListViewの各行をクリックした時の命令を実装</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemClick</span><span class="params">(AdapterView&lt;?&gt; adapterView, View view, <span class="keyword">int</span> i, <span class="keyword">long</span> l)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// クリックした行番号をToastで表示する</span></span><br><span class="line">        Toast.makeText(ResultListActivity.<span class="keyword">this</span></span><br><span class="line">                , i + <span class="string">"行目をクリックしました"</span></span><br><span class="line">                , Toast.LENGTH_SHORT).show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>コードの実装が終わったらエミュレータで確認して見ましょう。</p>
<p>今回のコード修正のポイントは<code>ResultListAdapter</code>クラスで利用した<code>LayoutInflater</code>クラスです。<br>各Activityでは画面に表示するレイアウトファイルの読み込みを<code>setContentView()</code>メソッドが担当していましたが、ListViewに表示するレイアウトの読み込みは<code>LayoutInflater</code>クラスを使う必要があるので注意しましょう。</p>
<h2><span id="スコープ">スコープ</span></h2><p>変数やクラスは宣言された時に参照/代入が可能な場所が決まっています。<br>以下の画像で宣言している変数やクラスは参照/代入の行える箇所が異なります。<br><img src="/AndroidCourse/android/06-TransitionScreen/scopedetail.png" width="500" title="Scope Area Detail"></p>
<p><font color="red">赤い枠</font>のエリアで宣言している変数やクラスを”メンバクラス”、”メンバ変数”と呼び、宣言したクラス内であればどのメソッド内でも参照/代入が可能です。<br>次に<font color="blue">青い枠</font>で宣言している<code>listItemClickEvent</code>インターフェースですが<code>onCreate()</code>などメソッド内で宣言された変数やクラスをローカル変数(クラス)と呼びます。<br>ローカル変数(クラス)は宣言したメソッド内でのみ参照/代入が行えます、そのためメソッドをまたいで参照/代入を行いたい場合はメンバ変数として宣言する必要があります。</p>
<p>各スコープのエリアは<code>{}</code>波括弧で括られているので宣言したオブジェクトのスコープを把握したい場合はクラスか、メソッドか<code>{}</code>を確認すると良いでしょう。<br>また、スコープを確認しやすくするためにもインデント(各行の前にある余白)が正確に設定されているとプログラムがわかりやすくなります。</p>
<h2><span id="アクセス修飾子">アクセス修飾子</span></h2><p>上記の修正コードにおいて変数の前に新しくキーワード<code>private</code>を付与しました。<br>このキーワードを<strong>アクセス修飾子</strong>と呼びます。<br>アクセス修飾子は継承や外部クラスでインスタンス化されたクラスから対象の変数/メソッドにアクセスができるかを定めるキーワードです。<br>例えば<code>private</code>で宣言された変数は宣言したクラス内でしか参照/代入ができません。<br><code>public</code>の場合には継承関係にある子クラス、インスタンス化されたクラスから参照/代入が可能と特徴が違います。<br>下表にてアクセス修飾子のアクセス可能箇所を”○”、不可能な領域には”×”にて示します。</p>
<table>
<thead>
<tr>
<th>アクセス修飾子</th>
<th>外部クラス</th>
<th>継承子クラス</th>
<th>宣言クラス内部</th>
</tr>
</thead>
<tbody>
<tr>
<td>public</td>
<td>○</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>protected</td>
<td>×</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>private</td>
<td>×</td>
<td>×</td>
<td>○</td>
</tr>
</tbody>
</table>
<p>メンバアクセス修飾子を設定できる項目は”クラス”,”メソッド”,”メンバ変数”の３項目です。</p>
<p>今回の実装で設定した内容においては<code>private</code>になるので外部からの一切のアクセスを禁じるように宣言しています。<br>javaプログラムにおいて色々なクラスから値の代入処理を行うと不具合やエラーが発生する原因になるため、それを防ぐ方法として必要以上のクラスからのアクセスを防ぐために活用します。</p>
<p>ここまでアクセス修飾子に触れませんでしたが、開発で不具合を減らすためには重要な概念です、覚えておきましょう。</p>
<p>以上で<strong>検索結果一覧画面の作成</strong>は一旦完了です。<br>次の<a href="/AndroidCourse/android/07-AsyncProcess">蔵書検索機能の作成</a>ではREST API通信を通して蔵書検索機能を作成します、<br>データが検索機能が完成したら、検索データを “ResultListActivity”で表示出来るよう修正していきます。</p>
</div><!-- comment system--><div class="container"><hr></div></article><footer id="footer"><div class="container"><div class="bar"><div class="social"><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><div class="footer">© 2018 <a href="/" rel="nofollow">kuririnz</a>. Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a>. Theme <a target="_blank" href="https://github.com/lotabout/very-simple">very-simple</a>.</div></div></div></footer><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});
</script></body><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
e=o.createElement(i);r=o.getElementsByTagName(i)[0];
e.src='//www.google-analytics.com/analytics.js';
r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
ga('create','UA-63175607-3');ga('send','pageview');</script></html>